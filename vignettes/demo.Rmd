---
title: "Using nhdR"
author: "Joseph Stachelek"
date: "`r Sys.Date()`"
output: rmarkdown::html_vignette
vignette: >
  %\VignetteIndexEntry{Using nhdR}
  %\VignetteEngine{knitr::rmarkdown}
  %\VignetteEncoding{UTF-8}
---

```{r message=FALSE}
library(wikilake)
library(sf)
library(nhdR)

nhd_plus_list()
wb <- nhd_plus_load("NHDWaterbody")

gull_meta <- wikilake::lake_wiki("Gull Lake (Michigan)")
gull <- st_sfc(st_point(c(gull_meta$Lon, gull_meta$Lat)))
gull_buff <- st_sfc(st_buffer(gull, dist = 0.05))
st_crs(gull) <- st_crs(gull_buff) <- 4326 #wgs84 epsg

gull      <- st_transform(gull, crs = "+proj=utm +zone=10 +datum=WGS84")  
gull_buff <- st_transform(gull_buff, crs = "+proj=utm +zone=10 +datum=WGS84")  
wb        <- st_transform(wb, crs = "+proj=utm +zone=10 +datum=WGS84")  
  
wb_intersecting <- unlist(lapply(st_intersects(wb, gull_buff), length)) > 0
wb_sub <- st_geometry(wb[wb_intersecting,])

plot(gull_buff)
plot(wb_sub, add = TRUE)
plot(gull, col = "red", pch = 19, add = TRUE)
```
